# API –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## üéØ –ù–æ–≤—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç: GET /users/:phone/profile

–ü–æ–ª—É—á–∞–µ—Ç –ø–æ–ª–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π –∏ –∏—Å—Ç–æ—Ä–∏–µ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π.

## üìã –ß—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç

### –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ:
- ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ò–º—è
- –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞
- –†–æ–ª—å (CLIENT/ADMIN)
- –¢–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å
- –î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- –î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
- –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- –û–±—â–∏–π –∑–∞—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π –∫–µ—à–±–µ–∫
- –û–±—â–∞—è —Å—É–º–º–∞ –ø–æ—Ç—Ä–∞—á–µ–Ω–Ω—ã—Ö –¥–µ–Ω–µ–≥
- –°—Ä–µ–¥–Ω–∏–π –∫–µ—à–±–µ–∫ –∑–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
- –î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

### –¢–æ–ø —Ç–æ–≤–∞—Ä—ã:
- 5 —Å–∞–º—ã—Ö –ø–æ–∫—É–ø–∞–µ–º—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–∫—É–ø–æ–∫ –∫–∞–∂–¥–æ–≥–æ —Ç–æ–≤–∞—Ä–∞
- –û–±—â–∞—è —Å—É–º–º–∞ –ø–æ—Ç—Ä–∞—á–µ–Ω–Ω–∞—è –Ω–∞ –∫–∞–∂–¥—ã–π —Ç–æ–≤–∞—Ä
- –û–±—â–∏–π –∫–µ—à–±–µ–∫ —Å –∫–∞–∂–¥–æ–≥–æ —Ç–æ–≤–∞—Ä–∞

### –ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π:
- –ü–æ—Å–ª–µ–¥–Ω–∏–µ 10 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π (–∫—Ä–∞—Ç–∫–∏–π —Å–ø–∏—Å–æ–∫)
- –í—Å–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (–ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫)

## üß™ –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞

```bash
curl -X GET http://localhost:8080/users/+996701234567/profile
```

## üìä –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞

```json
{
  "statusCode": 200,
  "message": "User profile retrieved successfully",
  "data": {
    "user": {
      "id": 3,
      "phoneNumber": "+996701234567",
      "name": "Test Admin",
      "role": "ADMIN",
      "balance": 15.2,
      "createdAt": "2024-01-01T00:00:00.000Z",
      "updatedAt": "2024-01-01T12:00:00.000Z"
    },
    "statistics": {
      "totalTransactions": 5,
      "totalCashbackEarned": 15.2,
      "totalSpent": 506.5,
      "averageCashbackPerTransaction": 3.0,
      "lastTransactionDate": "2024-01-01T12:00:00.000Z"
    },
    "recentTransactions": [
      {
        "id": 1,
        "productId": "1",
        "productName": "iPhone 15 Pro",
        "productPrice": 999.9,
        "cashbackAmount": 3.0,
        "balanceBefore": 12.2,
        "balanceAfter": 15.2,
        "createdAt": "2024-01-01T12:00:00.000Z"
      }
    ],
    "topProducts": [
      {
        "name": "iPhone 15 Pro",
        "count": 3,
        "totalSpent": 2999.7,
        "totalCashback": 9.0
      },
      {
        "name": "MacBook Pro",
        "count": 2,
        "totalSpent": 3999.8,
        "totalCashback": 6.2
      }
    ],
    "allTransactions": [
      // ... –≤—Å–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    ]
  }
}
```

## üîç –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### –û–∫—Ä—É–≥–ª–µ–Ω–∏–µ —á–∏—Å–µ–ª:
- –í—Å–µ –¥–µ–Ω–µ–∂–Ω—ã–µ —Å—É–º–º—ã –æ–∫—Ä—É–≥–ª—è—é—Ç—Å—è –¥–æ 1 –∑–Ω–∞–∫–∞ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `Math.round(value * 10) / 10`

### –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:
- –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Å–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –ø–æ –¥–∞—Ç–µ (–Ω–æ–≤—ã–µ —Å–Ω–∞—á–∞–ª–∞)
- –¢–æ–ø —Ç–æ–≤–∞—Ä—ã —Å–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø–æ–∫—É–ø–æ–∫ (–±–æ–ª—å—à–µ —Å–Ω–∞—á–∞–ª–∞)

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:
- –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω: `404 Not Found`
- –ï—Å–ª–∏ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –Ω–µ–≤–µ—Ä–Ω—ã–π: `400 Bad Request`

## üéØ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –î–ª—è –∞–¥–º–∏–Ω–∫–∏:
- –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–µ—Ç–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∫–ª–∏–µ–Ω—Ç–∞
- –ê–Ω–∞–ª–∏–∑ –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –î–ª—è –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞
- –ò—Å—Ç–æ—Ä–∏—è –ø–æ–∫—É–ø–æ–∫ –∏ –∫–µ—à–±–µ–∫–∞
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç–æ–≤–∞—Ä–∞–º

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç:
```bash
powershell -ExecutionPolicy Bypass -File test_user_profile.ps1
```

–°–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∂–µ—Ç:
- ‚úÖ –û—Å–Ω–æ–≤–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º
- ‚úÖ –¢–æ–ø —Ç–æ–≤–∞—Ä—ã
- ‚úÖ –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

## üîÑ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –¥—Ä—É–≥–∏–º–∏ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º–∏

| –≠–Ω–¥–ø–æ–∏–Ω—Ç | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –î–∞–Ω–Ω—ã–µ |
|----------|------------|--------|
| `/users/:phone/balance` | –¢–æ–ª—å–∫–æ –±–∞–ª–∞–Ω—Å | `{ balance: 15.2 }` |
| `/users/:phone/transactions` | –¢–æ–ª—å–∫–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ | `{ transactions: [...] }` |
| `/users/:phone/profile` | **–ü–æ–ª–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å** | `{ user, statistics, topProducts, transactions }` |

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

1. **–û–¥–∏–Ω –∑–∞–ø—Ä–æ—Å** - –ø–æ–ª—É—á–∞–µ—Ç–µ –≤—Å—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —Å—Ä–∞–∑—É
2. **–î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** - –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ –ø–æ–∫—É–ø–∫–∞–º
3. **–¢–æ–ø —Ç–æ–≤–∞—Ä—ã** - –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
4. **–ì–æ—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ** - –Ω–µ –Ω—É–∂–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ
5. **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ** - —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ –ë–î
